<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-122327085-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122327085-2');
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=1024">
    <link rel="icon" href="https://www.sih.gov.in/img/favicon-sih.png" type="image/png" sizes="16x16">
    <title>SIH 2019 Problem Statements</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <style>
        #preloader {
            position: fixed;
            top: 0;
            z-index: 999999;
            opacity: 1;
            visibility: visible;
            -webkit-transition: opacity 1s, visibility 1s;
            -o-transition: opacity 1s, visibility 1s;
            transition: opacity 1s, visibility 1s;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            width: 100vw;
            height: 100vh;
            -webkit-box-pack: center;
                -ms-flex-pack: center;
                    justify-content: center;
            -webkit-box-align: center;
                -ms-flex-align: center;
                    align-items: center;
            background-color: white;
        }
        #preloader img {
            -webkit-animation: breathe ease-in-out 1s infinite alternate;
                    animation: breathe ease-in-out 1s infinite alternate;
        }
        @-webkit-keyframes breathe {
            0% {
                -webkit-transform: scale(0.8);
                        transform: scale(0.8);
            } 100% {
                -webkit-transform: scale(1.2);
                        transform: scale(1.2);
            }
        }
        @keyframes breathe {
            0% {
                -webkit-transform: scale(0.8);
                        transform: scale(0.8);
            } 100% {
                -webkit-transform: scale(1.2);
                        transform: scale(1.2);
            }
        }
        .btn.Simple {
            color: #fff;
            background-color: #28a745;
            border-color: #28a745;
        }
        .btn.Complex {
            color: #212529;
            background-color: #ffc107;
            border-color: #ffc107;
        }
        .btn.Complicated {
            color: #fff;
            background-color: #dc3545;
            border-color: #dc3545;
        }
        .btn.Software {
            color: #fff;
            background-color: #007bff;
            border-color: #007bff;
        }
        .btn.Hardware {
            color: #fff;
            background-color: #343a40;
            border-color: #343a40;
        }
    </style>
</head>
<body >
    <nav class="navbar navbar-expand navbar-dark bg-dark fixed-top">
        <a class="navbar-brand" href="/update"><img src="https://www.sih.gov.in/img/favicon-sih.png" height="50px">&nbsp&nbspSIH 2019 Problem Statements</a>
        <form class="form-inline ml-auto">
            <select id="field" class="form-control col-3" onchange="searchFunction()">
                <option value="" selected>All Field</option>
                <option value="Agriculture and Rural Development">Agriculture and Rural Development</option>
                <option value="Clean Water">Clean Water</option>
                <option value="Robotics & Drones">Robotics & Drones</option>
                <option value="Healthcare & Biomedical Devices">Healthcare & Biomedical Devices</option>
                <option value="Energy / Renewable Energy">Energy / Renewable Energy</option>
                <option value="Security & Surveillance">Security & Surveillance</option>
                <option value="Smart Communication">Smart Communication</option>
                <option value="Smart Vehicles">Smart Vehicles</option>
                <option value="Software - Mobile App development">Software - Mobile App development</option>
                <option value="Miscellaneous">Miscellaneous</option>
                <option value="Software - Web App development">Software - Web App development</option>
                <option value="Travel and Tourism">Travel and Tourism</option>
                <option value="Finance">Finance</option>
                <option value="Life Sciences">Life Sciences</option>
                <option value="Waste Management">Waste Management</option>
                <option value="Food Technology">Food Technology</option>
                <option value="Students Innovation">Students Innovation</option>
                <option value="Smart Education">Smart Education</option>
                <option value="Smart Cities">Smart Cities</option>
                <option value="Sports and Fitness">Sports and Fitness</option>
                <option value="Smart Textiles">Smart Textiles</option>
                <option value="Sustainable Environment">Sustainable Environment</option>
            </select>
            <select id="category" class="form-control col-3 ml-3" onchange="searchFunction()">
                <option value="" selected>All Category</option>
                <option value=" Software">Software</option>
                <option value=" Hardware">Hardware</option>
            </select>
            <select id="complexity" class="form-control col-3 ml-3" onchange="searchFunction()">
                <option value="" selected>All Complexity</option>
                <option value=" Simple">Simple</option>
                <option value=" Complex">Complex</option>
                <option value=" Complicated">Complicated</option>
            </select>
            <input id="moreinfo" class="form-control col-2 ml-3" type="search" placeholder="Search..." onkeyup="searchFunction()">
        </form>
    </nav>
    <table class="table table-bordered" style="margin-top: 76px">
        <tbody id="tbody">
        <% problems.forEach(problem => { %>
            <tr>
                <td class="align-middle px-4">
                    <figure class="figure">
                        <img src="<%= problem.image %>" width="700px" class="figure-img img-fluid rounded">
                        <figcaption class="figure-caption text-center"><%= problem.organisation %></figcaption>
                    </figure>
                </td>
                <td class="align-middle pt-4 px-4">
                    <h3 class="text-dark"><%= problem.statement.head %></h3>
                    <h6><span class="text-primary">Type:</span> <%= problem.statement.type %>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class="text-primary">Field:</span> <%= problem.field %></h6>
                    <p class="text-justify mt-3"><%= problem.statement.description %></p>
                    <a href=<%= problem.statement.youtube %>><img src="https://png.icons8.com/color/youtube/96" width="50px"></a>
                    &nbsp
                    <button type="button" class="btn btn-info">Ideas Submitted <span class="badge badge-light"><%= problem.ideas %></span></button>
                    &nbsp&nbsp&nbsp
                    <button type="button" class="btn <%= problem.category %>">Category: <%= problem.category %></button>
                    &nbsp&nbsp&nbsp
                    <button type="button" class="btn <%= problem.complexity %>">Complexity: <%= problem.complexity %></button>
                    <p class="text-muted mt-3">Created at: <%= problem.statement.created %>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspUpdated at: <%= problem.statement.updated %></p>
                </td>
                <td class="search" style="display: none;"><%= problem.field %> <%= problem.category %> <%= problem.complexity %> <%= problem.field %> <%= problem.complexity %></td>
                <td class="moreinfo" style="display: none;"><%= problem.organisation %> <%= problem.statement.head %> <%= problem.statement.type %> <%= problem.statement.description %> ideas<%= problem.ideas %></td>
            </tr>
        <% }); %>
        </tbody>
    </table>
    <% if (pageNum === 1) { %>
        <div id="preloader"><img src="https://www.sih.gov.in/img/logo.png"></div>
    <% } %>
    <script>
        function searchFunction() {
            let field = $("#field"), category = $("#category"), complexity = $("#complexity"), moreinfo = $("#moreinfo"), problems = $("tr");
            if (!field.val() && !category.val() && !complexity.val()) {
                [...problems].forEach(problem => {
                    if ($(problem).find(".moreinfo").text().toUpperCase().indexOf(moreinfo.val().toUpperCase()) > -1 ){
                        $(problem).css("display", "");
                    } else {
                        $(problem).css("display", "none");
                    }
                });
            } else {
                [...problems].forEach(problem => {
                    if ($(problem).find(".search").text().toUpperCase().indexOf(field.val().toUpperCase()+category.val().toUpperCase()+complexity.val().toUpperCase()) > -1 ){
                        $(problem).css("display", "");
                    } else {
                        $(problem).css("display", "none");
                    }
                });
            }
        }
    <% if (pageNum + 1 <= totalPages) { %>
        function getProblems(pageNum) {
            $.ajax({
                url: "/",
                method: "POST",
                data: {
                    "pageNum": pageNum
                }
            }).done(problems => {
                problems.forEach(problem => {
                    const item = $("<tr></tr>");
                    item.html(`
                        <td class="align-middle px-4">
                            <figure class="figure">
                                <img src="${problem.image}" width="700px" class="figure-img img-fluid rounded">
                                <figcaption class="figure-caption text-center">${problem.organisation}</figcaption>
                            </figure>
                        </td>
                        <td class="align-middle pt-4 px-4">
                            <h3 class="text-dark">${problem.statement.head}</h3>
                            <h6><span class="text-primary">Type:</span> ${problem.statement.type}&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class="text-primary">Field:</span> ${problem.field}</h6>
                            <p class="text-justify mt-3">${problem.statement.description}</p>
                            <a href="${problem.statement.youtube}"><img src="https://png.icons8.com/color/youtube/96" width="50px"></a>
                            &nbsp
                            <button type="button" class="btn btn-info">Ideas Submitted <span class="badge badge-light">${problem.ideas}</span></button>
                            &nbsp&nbsp&nbsp
                            <button type="button" class="btn ${problem.category}">Category: ${problem.category}</button>
                            &nbsp&nbsp&nbsp
                            <button type="button" class="btn ${problem.complexity}">Complexity: ${problem.complexity}</button>
                            <p class="text-muted mt-3">Created at: ${problem.statement.created}&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspUpdated at: ${problem.statement.updated}</p>
                        </td>
                        <td class="search" style="display: none;">${problem.field} ${problem.category} ${problem.complexity} ${problem.field} ${problem.complexity}</td>
                        <td class="moreinfo" style="display: none;">${problem.organisation} ${problem.statement.head} ${problem.statement.type} ${problem.statement.description} ideas${problem.ideas}</td>
                    `);
                    $("#tbody").append(item);
                });
                <% if (pageNum === 1) { %>
                    $("#preloader").css({"opacity": "0", "visibility": "hidden"});
                <% } %>
                console.log("Scraped page " + pageNum);
                searchFunction();
                if (pageNum + 1 <= <%= totalPages %>) {
                    getProblems(pageNum + 1);
                }
            });
        }
        $(window).ready(() => getProblems(<%= pageNum %>));
    <% } %>
    </script>
</body>
</html>